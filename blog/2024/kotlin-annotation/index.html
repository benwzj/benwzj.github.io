<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Kotlin Annotation | BEN WEN</title> <meta name="author" content="Ben Wen"> <meta name="description" content="A website to show the world of Ben Wen "> <meta name="keywords" content="jekyll, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="stylesheet" href="/assets/css/mdb.min.css?d41d8cd98f00b204e9800998ecf8427e"> <link defer rel="stylesheet" href="/assets/css/bootstrap-table.min.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="stylesheet" href="/assets/css/all.min.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="stylesheet" href="/assets/css/academicons.min.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="/assets/css/github.css?d41d8cd98f00b204e9800998ecf8427e" media="" id="highlight_theme_light"> <link rel="icon" href="/assets/img/favicon.png"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://benwzj.github.io/blog/2024/kotlin-annotation/"> <link rel="stylesheet" href="/assets/css/native.css?d41d8cd98f00b204e9800998ecf8427e" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?96d6b3e1c3604aca8b6134c7afdd5db6"></script> <script src="/assets/js/dark_mode.js?9b17307bb950ffa2e34be0227f53558f"></script> <style>html{scroll-behavior:smooth}</style> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/">BEN WEN</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/about/">About</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">Blog<span class="sr-only">(current)</span></a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">Projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">Resume</a> </li> <li class="nav-item"> <a class="nav-link" href="https://github.com/benwzj" rel="external nofollow noopener" target="_blank"> GitHub <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="width:1rem;height:1rem;fill:currentColor"> <g data-name="Layer 2"><g data-name="external-link"> <rect width="24" height="24" opacity="0"></rect> <path d="M20 11a1 1 0 0 0-1 1v6a1 1 0 0 1-1 1H6a1 1 0 0 1-1-1V6a1 1 0 0 1 1-1h6a1 1 0 0 0 0-2H6a3 3 0 0 0-3 3v12a3 3 0 0 0 3 3h12a3 3 0 0 0 3-3v-6a1 1 0 0 0-1-1z"></path> <path d="M16 5h1.58l-6.29 6.28a1 1 0 0 0 0 1.42 1 1 0 0 0 1.42 0L19 6.42V8a1 1 0 0 0 1 1 1 1 0 0 0 1-1V4a1 1 0 0 0-1-1h-4a1 1 0 0 0 0 2z"></path> </g></g> </svg> </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="row"> <div class="post col-sm-9"> <h1 class="post-title">Kotlin Annotation</h1> <br> <br> <article class="post-content"> <div id="markdown-content"> <h2 id="what-is-annotations">What is Annotations</h2> <p>Annotations are means of attaching metadata to code.</p> <p>Annotations are a form of metadata that provide data about the program but are not part of the program itself. Annotations have <strong>no direct effect on the operation</strong> of the code they annotate. Instead, they are used by the compiler and various tools during the build process, and can also be accessed at runtime through reflection. Kotlin annotations can be applied to classes, functions, properties, property accessors, parameters, and constructors.</p> <p>Kotlin comes with a set of built-in annotations. You can define your own custom annotations.</p> <p>There are three main mechanisms that handle annotations:</p> <ul> <li>annotation processing,</li> <li>reflection, and</li> <li>lint.</li> </ul> <h3 id="purposes">Purposes</h3> <p>Annotations can be used for a wide range of purposes, from marking code as deprecated, to influencing how data is serialized, or even modifying the behavior of frameworks and libraries.</p> <ul> <li>influencing the compiler’s behavior</li> <li>guiding the use of frameworks or libraries</li> <li>providing metadata for runtime reflection</li> <li>enforcing coding standards</li> </ul> <h3 id="built-in-annotations">Built-in Annotations</h3> <p>Kotlin, like Java, comes with a set of built-in annotations. One commonly used annotation is <code class="language-plaintext highlighter-rouge">@Deprecated</code>, which marks a program element as deprecated. For example:</p> <div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Deprecated</span><span class="p">(</span><span class="s">"This function will be removed in future releases."</span><span class="p">)</span>
<span class="k">fun</span> <span class="nf">oldFunction</span><span class="p">()</span> <span class="p">{</span> <span class="p">}</span>
</code></pre></div></div> <h3 id="declaring-an-custom-annotation">Declaring an custom Annotation</h3> <p>To declare an annotation, put the annotation modifier in front of a class:</p> <div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">annotation</span> <span class="kd">class</span> <span class="nc">Fancy</span>
</code></pre></div></div> <h3 id="using-annotations">Using Annotations</h3> <p>Once declared, this annotation can be used to annotate various program elements. For example:</p> <div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Fancy</span> <span class="kd">class</span> <span class="nc">MyClass</span> <span class="p">{</span> <span class="p">}</span>
<span class="nd">@Fancy</span> <span class="k">fun</span> <span class="nf">myFunction</span><span class="p">()</span> <span class="p">{</span> <span class="p">}</span>
</code></pre></div></div> <h3 id="features">Features</h3> <ul> <li>Support Annotation Parameters</li> <li>Java Interoperability</li> <li>Enhancing Code Readability and Maintainability: It better then comment in some circumstance, because it can, for example influencing the compiler’s behavior.</li> <li>Enforcing Coding Conventions and Safety, either at compile-time or runtime.</li> <li>Integration with Frameworks and Libraries: Many frameworks and libraries leverage annotations to allow developers to configure behavior or integrate custom logic seamlessly. By creating custom annotations, developers can extend these frameworks in powerful and flexible ways.</li> <li>Simplifying Configuration.</li> </ul> <h2 id="example">Example</h2> <h3 id="specify-annotation-targets">Specify Annotation Targets</h3> <p>By default, a Kotlin annotation can be used on any declaration. However, you might want to restrict your annotation to certain types of declarations (e.g., functions, classes, properties). You can do this using the <code class="language-plaintext highlighter-rouge">@Target</code> meta-annotation.</p> <div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Target</span><span class="p">(</span><span class="nc">AnnotationTarget</span><span class="p">.</span><span class="nc">FUNCTION</span><span class="p">,</span> <span class="nc">AnnotationTarget</span><span class="p">.</span><span class="nc">CLASS</span><span class="p">)</span>
<span class="k">annotation</span> <span class="kd">class</span> <span class="nc">Loggable</span>
</code></pre></div></div> <p>In this example, <code class="language-plaintext highlighter-rouge">@Loggable</code> can only be applied to functions and classes.</p> <h3 id="add-parameters-to-your-annotation">Add Parameters to Your Annotation</h3> <p>Annotations can have parameters to allow for more flexible and detailed configuration. Parameters are declared in the primary constructor of the annotation class.</p> <div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">annotation</span> <span class="kd">class</span> <span class="nc">Loggable</span><span class="p">(</span><span class="kd">val</span> <span class="py">level</span><span class="p">:</span> <span class="nc">String</span> <span class="p">=</span> <span class="s">"INFO"</span><span class="p">)</span>
</code></pre></div></div> <p>Here, <code class="language-plaintext highlighter-rouge">@Loggable</code> includes an optional level parameter that specifies the logging level, with a default value of “INFO”.</p> <div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Loggable</span><span class="p">(</span><span class="n">level</span> <span class="p">=</span> <span class="s">"DEBUG"</span><span class="p">)</span>
<span class="kd">class</span> <span class="nc">UserService</span>
</code></pre></div></div> <h3 id="retention-policy">Retention Policy</h3> <p>The retention policy of an annotation determines at which point the annotation is discarded during the compilation and execution of your program. Both Kotlin and Java support three types of retention policies:</p> <p>Source: The annotation is only available in the source code and is discarded by the compiler. Binary: The annotation is retained in the compiled class files but not available at runtime. Runtime: The annotation is available at runtime through reflection. In Kotlin, you specify the retention policy using the @Retention annotation:</p> <div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Retention</span><span class="p">(</span><span class="nc">AnnotationRetention</span><span class="p">.</span><span class="nc">SOURCE</span><span class="p">)</span>
<span class="k">annotation</span> <span class="kd">class</span> <span class="nc">DebugLog</span>
</code></pre></div></div> <p>This @DebugLog annotation is only available in the source code, making it useful for annotations that are intended to be processed by tools that analyze the source code.</p> <h3 id="use-reflection">use reflection</h3> <p>Reflection: read annotations at runtime. To check if a function is annotated with @Loggable and print a message accordingly, you might use reflection like this:</p> <div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">fun</span> <span class="nf">checkLoggable</span><span class="p">(</span><span class="n">function</span><span class="p">:</span> <span class="nc">KFunction</span><span class="p">&lt;</span><span class="err">*</span><span class="p">&gt;)</span> <span class="p">{</span>
  <span class="n">function</span><span class="p">.</span><span class="n">findAnnotation</span><span class="p">&lt;</span><span class="nc">Loggable</span><span class="p">&gt;()</span><span class="o">?.</span><span class="nf">let</span> <span class="p">{</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"Function ${function.name} is loggable with level ${it.level}."</span><span class="p">)</span> 
  <span class="p">}</span>
<span class="p">}</span>
    
<span class="c1">// Usage</span>
<span class="nf">checkLoggable</span><span class="p">(</span><span class="o">::</span><span class="n">updateUser</span><span class="p">)</span>
</code></pre></div></div> <h2 id="annotation-processing">Annotation Processing</h2> <p>Annotation processors are compiler plugins that generate code based on annotations at compile time. You know a third-party library includes an annotation processor when it requires using <code class="language-plaintext highlighter-rouge">annotationProcessor</code>, <code class="language-plaintext highlighter-rouge">kapt</code> or <code class="language-plaintext highlighter-rouge">ksp</code> instead of implementation as its build.gradle dependency configuration. Popular libraries that rely on annotation processing include Dagger (<code class="language-plaintext highlighter-rouge">@Provides</code>, <code class="language-plaintext highlighter-rouge">@Inject</code>), Moshi (<code class="language-plaintext highlighter-rouge">@Json</code>), and Room (<code class="language-plaintext highlighter-rouge">@Entity</code>, <code class="language-plaintext highlighter-rouge">@Dao</code>).</p> <p>An annotation processor must be registered to the compiler for it to run during compilation. The most common way to register one is via Google’s AutoService library — just annotate your processor with <code class="language-plaintext highlighter-rouge">@AutoService(Processor.class)</code>.</p> <h2 id="references">References</h2> <ul> <li><a href="https://kotlinlang.org/docs/annotations.html" rel="external nofollow noopener" target="_blank">annotation official doc</a></li> </ul> </div> </article> </div> <div class="col-sm-3 post-side-container"> <div class="card hoverable post-side-sticky"> <div class="card-body post-side-detail"> <h5 class="card-title">Post Detail</h5> <div class="detail-item"> <div class="item-title">Published : </div> <div class="item-content">Jul 4, 2024</div> </div> <div class="detail-item"> <div class="item-title">Category : </div> <div class="item-content"> <a href="/blog/category/android"> <i class="fas fa-tag fa-sm"></i> Android</a> </div> </div> <div class="detail-item"> <div class="item-title">Tags : </div> </div> <div class="tags"> <a href="/blog/tag/android"> <div class="tag"> Android </div> </a> <a href="/blog/tag/kotlin"> <div class="tag"> Kotlin </div> </a> </div> </div> </div> </div> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2025 Ben Wen. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a>. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="/assets/js/jquery.min.js?d41d8cd98f00b204e9800998ecf8427e"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js?d633890033921b33e0ceb13d22340a9c"></script> <script defer src="/assets/js/common.js?acdb9690d7641b2f8d40529018c71a01"></script> <script defer src="/assets/js/copy_code.js?c9d9dd48933de3831b3ee5ec9c209cac" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="/assets/js/tex-mml-chtml.js?d41d8cd98f00b204e9800998ecf8427e"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>